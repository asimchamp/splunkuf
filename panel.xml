<form version="1.1" theme="dark">
  <label>Search Performance Monitoring Dashboard</label>
  <description>Comprehensive monitoring for Search Head performance, scheduler efficiency, concurrency limits, and resource optimization - Identifies issues, gaps, and provides actionable resolutions</description>
  <search id="concurrency_base">
    <query>
| rest "/services/server/status/limits/search-concurrency" splunk_server=local 
| eval max_hist=max_hist_searches, max_realtime=max_realtime_searches 
| eval max_searches=max_hist+max_realtime 
| fields max_hist 
| rename max_hist as max_searches 
| appendcols 
    [search index=_internal source=*metrics.log group="search_concurrency" host=$host_token$
    | bin span=1m _time 
    | stats sum(active_hist_searches) as active_hist, sum(active_realtime_searches) as active_realtime by _time 
    | stats avg(active_hist) as active_hist, avg(active_realtime_searches) as active_realtime 
    | fillnull value=0 active_hist, active_realtime
    | eval current_searches=round(active_hist+active_realtime, 2)
    | fields _time current_searches active_hist active_realtime] 
| fillnull value=0 current_searches 
| eval utilization_pct=round((current_searches/max_searches)*100, 2)
        </query>
    <earliest>$time_token.earliest$</earliest>
    <latest>$time_token.latest$</latest>
  </search>
  <fieldset submitButton="true" autoRun="true">
    <input type="time" token="time_token" searchWhenChanged="true">
      <label>Time Range</label>
      <default>
        <earliest>-4h@h</earliest>
        <latest>now</latest>
      </default>
    </input>
    <input type="dropdown" token="host_token">
      <label>Host</label>
      <choice value="sh-i-0c8330bc1285b6764.regeneron.splunkcloud.com">ES</choice>
      <default>Asims-MacBook-Pro.local</default>
      <initialValue>Asims-MacBook-Pro.local</initialValue>
    </input>
  </fieldset>
  <row>
    <panel>
      <html>
        <h1 style="text-align:center; color:#1e93ff; font-size:24px; padding:10px; border-radius:8px;">
          ğŸš€ Executive Dashboard - Search Performance Health
        </h1>
      </html>
    </panel>
  </row>
  <row>
    <panel>
      <title>ğŸ”„ Search Concurrency Health (Current vs Maximum)</title>
      <!-- Base search combining metrics.log for active searches and REST for limits -->
      <single>
        <title>Current Concurrent Searches</title>
        <search base="concurrency_base">
          <query>| stats latest(current_searches) as current_searches, latest(max_searches) as max_searches
| eval utilization_pct=round((current_searches/max_searches)*100,2)
| eval status=case(
    utilization_pct &gt;= 80, "CRITICAL",
    utilization_pct &gt;= 60, "ELEVATED",
    1=1, "HEALTHY"
  )
| eval display_value=current_searches." / ".max_searches
| fields display_value, utilization_pct, status, current_searches, max_searches</query>
        </search>
        <option name="drilldown">all</option>
        <option name="rangeColors">["0x65a637","0xf7bc38","0xd93f3c"]</option>
        <option name="rangeValues">[60,100]</option>
        <option name="refresh.display">preview</option>
        <option name="underLabel">Utilization %</option>
        <option name="unit">searches</option>
        <option name="useColors">1</option>
        <option name="useThousandSeparators">1</option>
        <drilldown>
          <link target="_blank">search?q=%7C%20rest%20%22%2Fservices%2Fserver%2Fstatus%2Flimits%2Fsearch-concurrency%22&amp;earliest=$time_token.earliest$&amp;latest=$time_token.latest$</link>
        </drilldown>
      </single>
    </panel>
    <panel>
      <title>ğŸ¯ Concurrency Gauge</title>
      <single>
        <search base="concurrency_base">
          <query>
| stats latest(utilization_pct) as utilization_pct
| fields utilization_pct
          </query>
        </search>
        <option name="colorMode">block</option>
        <option name="height">115</option>
        <option name="numberPrecision">0.00</option>
        <option name="rangeColors">["0x65a637","0xf7bc38","0xd93f3c"]</option>
        <option name="rangeValues">[60,80]</option>
        <option name="underLabel">Capacity Used</option>
        <option name="unit">%</option>
        <option name="useColors">1</option>
      </single>
    </panel>
  </row>
  <row>
    <panel>
      <title>ğŸ“ˆ Concurrency Trend (1-min intervals)</title>
      <chart>
        <search>
          <query>index=_internal source=*metrics.log group="search_concurrency" host="$host_token$" 
| bin span=1m _time 
| stats sum(active_hist_searches) as active_hist, sum(active_realtime_searches) as active_realtime by _time 
| fillnull value=0 active_hist, active_realtime 
| eval current_searches=round(active_hist+active_realtime, 2) 
| eval max_hist = "78"
| fields _time current_searches max_hist</query>
          <earliest>$time_token.earliest$</earliest>
          <latest>$time_token.latest$</latest>
        </search>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.chart">line</option>
        <option name="charting.chart.overlayFields">"Utilization %"</option>
        <option name="charting.chart.showDataLabels">none</option>
        <option name="charting.fieldColors">{"Utilization %": "#FF6B6B", "Active Searches": "#4ECDC4"}</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">bottom</option>
        <option name="charting.lineWidth">2</option>
        <option name="refresh.display">progressbar</option>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <title>ğŸ”¥ Searches Heatmap - GitHub Style (Day x Hour Matrix)</title>
      <table>
        <search>
          <query>index=_internal  host=$host_token$ sourcetype=scheduler status="*"
| bin _time span=1h
| eval hour=strftime(_time, "%H")
| eval day=strftime(_time, "%A")
| eval day_order=case(
    day="Monday", 1,
    day="Tuesday", 2,
    day="Wednesday", 3,
    day="Thursday", 4,
    day="Friday", 5,
    day="Saturday", 6,
    day="Sunday", 7
  )
| stats sum(eval(1)) as search_count by day, day_order, hour
| eval severity=case(
    search_count &gt; 35, "ğŸ”´ Critical",
    search_count &gt; 30, "ğŸŸ  High",
    search_count &gt; 25, "ğŸŸ¡ Moderate",
    search_count &gt; 20, "ğŸŸ¢ Low",
    1=1, "âšª None"
  )
| eval display_value=search_count
``` Append all possible day-hour combinations to ensure complete matrix```
| appendpipe 
    [| stats count 
    | eval day="Monday,Tuesday,Wednesday,Thursday,Friday,Saturday,Sunday"
    | makemv delim="," day
    | mvexpand day
    | eval hour="00,01,02,03,04,05,06,07,08,09,10,11,12,13,14,15,16,17,18,19,20,21,22,23"
    | makemv delim="," hour
    | mvexpand hour
    | eval search_count=0, display_value=0
    | eval day_order=case(
        day="Monday", 1,
        day="Tuesday", 2,
        day="Wednesday", 3,
        day="Thursday", 4,
        day="Friday", 5,
        day="Saturday", 6,
        day="Sunday", 7
      )]
``` Aggregate and keep max values (real data over zeros)```
| stats max(search_count) as search_count, max(day_order) as day_order by day, hour
| eval severity=case(
    search_count &gt; 35, "ğŸ”´ Critical",
    search_count &gt; 30, "ğŸŸ  High",
    search_count &gt; 25, "ğŸŸ¡ Moderate",
    search_count &gt; 20, "ğŸŸ¢ Low",
    1=1, "âšª None"
  )
| eval display_value=if(search_count=0, "-", tostring(search_count))
``` Create matrix format with days as rows and hours as columns```
| xyseries day hour display_value
| eval day_order=case(
    day="Monday", 1,
    day="Tuesday", 2,
    day="Wednesday", 3,
    day="Thursday", 4,
    day="Friday", 5,
    day="Saturday", 6,
    day="Sunday", 7
  )
| sort day_order
| fields - day_order
| fillnull value="-"</query>
          <earliest>-7d</earliest>
          <latest>now</latest>
        </search>
        <!-- Format day column -->
        <!-- Apply heatmap colors to all hour columns -->
        <option name="count">10</option>
        <option name="dataOverlayMode">heatmap</option>
        <option name="drilldown">cell</option>
        <option name="refresh.display">progressbar</option>
        <option name="rowNumbers">false</option>
        <option name="wrap">false</option>
        <format type="color" field="day">
          <colorPalette type="map">{"Monday": "#1e93ff", "Tuesday": "#1e93ff", "Wednesday": "#1e93ff", "Thursday": "#1e93ff", "Friday": "#1e93ff", "Saturday": "#4ECDC4", "Sunday": "#4ECDC4"}</colorPalette>
        </format>
        <format type="color" field="00">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="1700" midValue="1750" maxValue="1800"></scale>
        </format>
        <format type="color" field="01">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="1700" midValue="1750" maxValue="1800"></scale>
        </format>
        <format type="color" field="02">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="1700" midValue="1750" maxValue="1800"></scale>
        </format>
        <format type="color" field="03">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="1700" midValue="1750" maxValue="1800"></scale>
        </format>
        <format type="color" field="04">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="1700" midValue="1750" maxValue="1800"></scale>
        </format>
        <format type="color" field="05">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="1700" midValue="1750" maxValue="1800"></scale>
        </format>
        <format type="color" field="06">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="1700" midValue="1750" maxValue="1800"></scale>
        </format>
        <format type="color" field="07">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="1700" midValue="1750" maxValue="1800"></scale>
        </format>
        <format type="color" field="08">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="1700" midValue="1750" maxValue="1800"></scale>
        </format>
        <format type="color" field="09">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="1700" midValue="1750" maxValue="1800"></scale>
        </format>
        <format type="color" field="10">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="1700" midValue="1750" maxValue="1800"></scale>
        </format>
        <format type="color" field="11">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="1700" midValue="1750" maxValue="1800"></scale>
        </format>
        <format type="color" field="12">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="1700" midValue="1750" maxValue="1800"></scale>
        </format>
        <format type="color" field="13">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="1700" midValue="1750" maxValue="1800"></scale>
        </format>
        <format type="color" field="14">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="1700" midValue="1750" maxValue="1800"></scale>
        </format>
        <format type="color" field="15">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="1700" midValue="1750" maxValue="1800"></scale>
        </format>
        <format type="color" field="16">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="1700" midValue="1750" maxValue="1800"></scale>
        </format>
        <format type="color" field="17">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="1700" midValue="1750" maxValue="1800"></scale>
        </format>
        <format type="color" field="18">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="1700" midValue="1750" maxValue="1800"></scale>
        </format>
        <format type="color" field="19">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="1700" midValue="1750" maxValue="1800"></scale>
        </format>
        <format type="color" field="20">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="1700" midValue="1750" maxValue="1800"></scale>
        </format>
        <format type="color" field="21">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="1700" midValue="1750" maxValue="1800"></scale>
        </format>
        <format type="color" field="22">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="1700" midValue="1750" maxValue="1800"></scale>
        </format>
        <format type="color" field="23">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="1700" midValue="1750" maxValue="1800"></scale>
        </format>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>ğŸ”¥ Searches Heatmap - Last 30 Days (Date x Hour Matrix)</title>
      <table>
        <search>
          <query>index=_internal  host=$host_token$ sourcetype=scheduler status="*"
| bin _time span=1h
| eval hour=strftime(_time, "%H")
| eval date=strftime(_time, "%m/%d/%Y")
| eval day_of_week=strftime(_time, "%a")
| eval date_epoch=strftime(_time, "%Y%m%d")
| eval is_weekend=if(day_of_week="Sat" OR day_of_week="Sun", 1, 0)
| stats sum(eval(1)) as search_count, max(day_of_week) as day_of_week, max(is_weekend) as is_weekend by date, date_epoch, hour
| eval severity=case(
    search_count &gt; 35, "ğŸ”´ Critical",
    search_count &gt; 30, "ğŸŸ  High",
    search_count &gt; 25, "ğŸŸ¡ Moderate",
    search_count &gt; 20, "ğŸŸ¢ Low",
    1=1, "âšª None"
  )
| eval display_value=search_count
``` Create matrix format with dates as rows and hours as columns```
| eval date_display=date." (".day_of_week.")"
| xyseries date_display hour display_value
| eval date_sort=strftime(strptime(substr(date_display, 1, 10), "%m/%d/%Y"), "%Y%m%d")
| sort - date_sort
| fields - date_sort
| rename date_display as date
| fillnull value="-"</query>
          <earliest>-30d</earliest>
          <latest>now</latest>
        </search>
        <!-- Format date column -->
        <!-- Apply heatmap colors to all hour columns -->
        <option name="count">30</option>
        <option name="dataOverlayMode">heatmap</option>
        <option name="drilldown">cell</option>
        <option name="refresh.display">progressbar</option>
        <option name="rowNumbers">false</option>
        <option name="wrap">false</option>
        <format type="color" field="date">
          <colorPalette type="expression">case(match(value, "\(Sat\)|\(Sun\)"), "#4ECDC4", 1=1, "#1e93ff")</colorPalette>
        </format>
        <format type="color" field="00">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="1700" midValue="1750" maxValue="1800"></scale>
        </format>
        <format type="color" field="01">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="1700" midValue="1750" maxValue="1800"></scale>
        </format>
        <format type="color" field="02">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="1700" midValue="1750" maxValue="1800"></scale>
        </format>
        <format type="color" field="03">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="1700" midValue="1750" maxValue="1800"></scale>
        </format>
        <format type="color" field="04">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="1700" midValue="1750" maxValue="1800"></scale>
        </format>
        <format type="color" field="05">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="1700" midValue="1750" maxValue="1800"></scale>
        </format>
        <format type="color" field="06">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="1700" midValue="1750" maxValue="1800"></scale>
        </format>
        <format type="color" field="07">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="1700" midValue="1750" maxValue="1800"></scale>
        </format>
        <format type="color" field="08">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="1700" midValue="1750" maxValue="1800"></scale>
        </format>
        <format type="color" field="09">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="1700" midValue="1750" maxValue="1800"></scale>
        </format>
        <format type="color" field="10">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="1700" midValue="1750" maxValue="1800"></scale>
        </format>
        <format type="color" field="11">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="1700" midValue="1750" maxValue="1800"></scale>
        </format>
        <format type="color" field="12">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="1700" midValue="1750" maxValue="1800"></scale>
        </format>
        <format type="color" field="13">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="1700" midValue="1750" maxValue="1800"></scale>
        </format>
        <format type="color" field="14">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="1700" midValue="1750" maxValue="1800"></scale>
        </format>
        <format type="color" field="15">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="1700" midValue="1750" maxValue="1800"></scale>
        </format>
        <format type="color" field="16">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="1700" midValue="1750" maxValue="1800"></scale>
        </format>
        <format type="color" field="17">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="1700" midValue="1750" maxValue="1800"></scale>
        </format>
        <format type="color" field="18">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="1700" midValue="1750" maxValue="1800"></scale>
        </format>
        <format type="color" field="19">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="1700" midValue="1750" maxValue="1800"></scale>
        </format>
        <format type="color" field="20">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="1700" midValue="1750" maxValue="1800"></scale>
        </format>
        <format type="color" field="21">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="1700" midValue="1750" maxValue="1800"></scale>
        </format>
        <format type="color" field="22">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="1700" midValue="1750" maxValue="1800"></scale>
        </format>
        <format type="color" field="23">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="1700" midValue="1750" maxValue="1800"></scale>
        </format>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>ğŸ”¥ Skipped Searches Heatmap - GitHub Style (Day x Hour Matrix)</title>
      <table>
        <search>
          <query>index=_internal  host=$host_token$ sourcetype=scheduler status="skipped" search_type=scheduled
| bin _time span=1h
| eval hour=strftime(_time, "%H")
| eval day=strftime(_time, "%A")
| eval day_order=case(
day="Monday", 1,
    day="Tuesday", 2,
    day="Wednesday", 3,
    day="Thursday", 4,
    day="Friday", 5,
    day="Saturday", 6,
    day="Sunday", 7
  )
| stats sum(eval(1)) as search_count by day, day_order, hour
| eval severity=case(
    search_count &gt; 10, "ğŸ”´ Critical",
    search_count &gt; 5, "ğŸŸ  High",
    search_count &gt; 1, "ğŸŸ¡ Moderate",
    search_count &gt; 0, "ğŸŸ¢ Low",
    1=1, "âšª None"
  )
| eval display_value=search_count
``` Append all possible day-hour combinations to ensure complete matrix```
| appendpipe 
    [| stats count 
    | eval day="Monday,Tuesday,Wednesday,Thursday,Friday,Saturday,Sunday"
    | makemv delim="," day
    | mvexpand day
    | eval hour="00,01,02,03,04,05,06,07,08,09,10,11,12,13,14,15,16,17,18,19,20,21,22,23"
    | makemv delim="," hour
    | mvexpand hour
    | eval search_count=0, display_value=0
    | eval day_order=case(
        day="Monday", 1,
        day="Tuesday", 2,
        day="Wednesday", 3,
        day="Thursday", 4,
        day="Friday", 5,
        day="Saturday", 6,
        day="Sunday", 7
      )]
``` Aggregate and keep max values (real data over zeros)```
| stats max(search_count) as search_count, max(day_order) as day_order by day, hour
| eval severity=case(
    search_count &gt; 10, "ğŸ”´ Critical",
    search_count &gt; 5, "ğŸŸ  High",
    search_count &gt; 1, "ğŸŸ¡ Moderate",
    search_count &gt; 0, "ğŸŸ¢ Low",
    1=1, "âšª None"
  )
| eval display_value=if(search_count=0, "-", tostring(search_count))
``` Create matrix format with days as rows and hours as columns```
| xyseries day hour display_value
| eval day_order=case(
    day="Monday", 1,
    day="Tuesday", 2,
    day="Wednesday", 3,
    day="Thursday", 4,
    day="Friday", 5,
    day="Saturday", 6,
    day="Sunday", 7
  )
| sort day_order
| fields - day_order
| fillnull value="-"</query>
          <earliest>-7d</earliest>
          <latest>now</latest>
        </search>
        <!-- Format day column -->
        <!-- Apply heatmap colors to all hour columns -->
        <option name="count">10</option>
        <option name="dataOverlayMode">heatmap</option>
        <option name="drilldown">cell</option>
        <option name="refresh.display">progressbar</option>
        <option name="rowNumbers">false</option>
        <option name="wrap">false</option>
        <format type="color" field="day">
          <colorPalette type="map">{"Monday": "#1e93ff", "Tuesday": "#1e93ff", "Wednesday": "#1e93ff", "Thursday": "#1e93ff", "Friday": "#1e93ff", "Saturday": "#4ECDC4", "Sunday": "#4ECDC4"}</colorPalette>
        </format>
        <format type="color" field="00">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="0" midValue="3" maxValue="10"></scale>
        </format>
        <format type="color" field="01">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="0" midValue="3" maxValue="10"></scale>
        </format>
        <format type="color" field="02">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="0" midValue="3" maxValue="10"></scale>
        </format>
        <format type="color" field="03">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="0" midValue="3" maxValue="10"></scale>
        </format>
        <format type="color" field="04">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="0" midValue="3" maxValue="10"></scale>
        </format>
        <format type="color" field="05">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="0" midValue="3" maxValue="10"></scale>
        </format>
        <format type="color" field="06">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="0" midValue="3" maxValue="10"></scale>
        </format>
        <format type="color" field="07">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="0" midValue="3" maxValue="10"></scale>
        </format>
        <format type="color" field="08">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="0" midValue="3" maxValue="10"></scale>
        </format>
        <format type="color" field="09">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="0" midValue="3" maxValue="10"></scale>
        </format>
        <format type="color" field="10">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="0" midValue="3" maxValue="10"></scale>
        </format>
        <format type="color" field="11">
          <colorPalette type="minMidMax" maxColor="#f7bc38" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="0" midValue="3" maxValue="10"></scale>
        </format>
        <format type="color" field="12">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="0" midValue="3" maxValue="10"></scale>
        </format>
        <format type="color" field="13">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="0" midValue="3" maxValue="10"></scale>
        </format>
        <format type="color" field="14">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="0" midValue="3" maxValue="10"></scale>
        </format>
        <format type="color" field="15">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="0" midValue="3" maxValue="10"></scale>
        </format>
        <format type="color" field="16">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="0" midValue="3" maxValue="10"></scale>
        </format>
        <format type="color" field="17">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="0" midValue="3" maxValue="10"></scale>
        </format>
        <format type="color" field="18">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="0" midValue="3" maxValue="10"></scale>
        </format>
        <format type="color" field="19">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="0" midValue="3" maxValue="10"></scale>
        </format>
        <format type="color" field="20">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="0" midValue="3" maxValue="10"></scale>
        </format>
        <format type="color" field="21">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="0" midValue="3" maxValue="10"></scale>
        </format>
        <format type="color" field="22">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="0" midValue="3" maxValue="10"></scale>
        </format>
        <format type="color" field="23">
          <colorPalette type="minMidMax" maxColor="#d93f3c" midColor="#f7bc38" minColor="#65a637"></colorPalette>
          <scale type="minMidMax" minValue="0" midValue="3" maxValue="10"></scale>
        </format>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>âš ï¸ Skipped Searches Analysis - Root Cause Breakdown</title>
      <chart>
        <title>Skipped Searches Over Time (Hourly Pattern)</title>
        <search>
          <query>index=_internal host=$host_token$ sourcetype=scheduler status="skipped" search_type!="*acceleration"
| eval skip_reason=coalesce(reason, "unknown")
| timechart count by skip_reason limit=10</query>
          <earliest>$time_token.earliest$</earliest>
          <latest>$time_token.latest$</latest>
        </search>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">-45</option>
        <option name="charting.axisTitleX.text">Time</option>
        <option name="charting.axisTitleY.text">Skip Count</option>
        <option name="charting.chart">column</option>
        <option name="charting.chart.stackMode">stacked</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.fieldColors">{"max_concurrent_searches": "#d93f3c", "window closed": "#f7bc38", "quota exceeded": "#ff6b6b", "unknown": "#a0a0a0"}</option>
        <option name="charting.legend.placement">right</option>
        <option name="refresh.display">progressbar</option>
        <drilldown>
          <link target="_blank">search?q=index%3D_internal%20sourcetype%3Dscheduler%20status%3D%22skipped%22%20%7C%20table%20_time%20host%20app%20savedsearch_name%20reason%20user&amp;earliest=$time_token.earliest$&amp;latest=$time_token.latest$</link>
        </drilldown>
      </chart>
    </panel>
    <panel>
      <title>ğŸ‘¥ Skips by Search Owner</title>
      <chart>
        <search>
          <query>
index=_internal host=$host_token$ sourcetype=scheduler status="skipped" search_type!="*acceleration"
| stats count as skip_count by user
| sort -skip_count
| head 10
          </query>
          <earliest>$time_token.earliest$</earliest>
          <latest>$time_token.latest$</latest>
        </search>
        <option name="charting.chart">pie</option>
        <option name="charting.chart.showPercent">true</option>
        <option name="charting.legend.placement">right</option>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <title>ğŸ“‹ Skip Details by Reason</title>
      <table>
        <search>
          <query>index=_internal host=$host_token$ sourcetype=scheduler status="skipped" search_type!="*acceleration"
| eval skip_reason=coalesce(reason, "unknown")
| stats count as skip_count, values(savedsearch_name) as affected_searches, dc(savedsearch_name) as unique_searches, values(user) as owners by skip_reason
| eval affected_searches=mvindex(affected_searches, 0, 5)
| sort -skip_count
| eval severity=case(
    skip_count &gt; 5, "ğŸ”´ CRITICAL",
    skip_count &gt; 1, "ğŸŸ¡ ELEVATED",
    1=1, "ğŸŸ¢ NORMAL"
  )
| table severity, skip_reason, skip_count, unique_searches, owners, affected_searches
| rename severity as "Severity", skip_reason as "Skip Reason", skip_count as "Total Skips", unique_searches as "Unique Searches", owners as "Owners", affected_searches as "Sample Searches (5)"</query>
          <earliest>$time_token.earliest$</earliest>
          <latest>$time_token.latest$</latest>
        </search>
        <option name="count">10</option>
        <option name="dataOverlayMode">heatmap</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <option name="rowNumbers">true</option>
        <format type="color" field="Severity">
          <colorPalette type="map">{"ğŸ”´ CRITICAL": "#d93f3c", "ğŸŸ¡ ELEVATED": "#f7bc38", "ğŸŸ¢ NORMAL": "#65a637"}</colorPalette>
        </format>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>ğŸ’» Search Head CPU Performance by Host Group (90th Percentile)</title>
      <chart>
        <title>ğŸ–¥ï¸ CPU Usage by Host Group (15-min intervals, 90th percentile)</title>
        <search>
          <query>index=_cmc_summary  source="splunk-metrics-summary" component=hostwide host_group!=indexer 
    [ rest /services/server/info splunk_server=local 
    | fields splunk_server 
    | rex field=splunk_server "^[^.]+[.](?&lt;stack&gt;[^.]+)" 
    | eval host="*.".stack.".*splunk*" 
    | fields host] 
| timechart span=1h fixedrange=false exactperc90(cpuUsedPct) as cpuUsedPct_P90 by host_group 
| eval Elevated=60, Critical=80</query>
          <earliest>$time_token.earliest$</earliest>
          <latest>$time_token.latest$</latest>
        </search>
        <option name="charting.axisTitleX.text">Time</option>
        <option name="charting.axisTitleY.text">CPU % (90th Percentile)</option>
        <option name="charting.axisY.maximumNumber">100</option>
        <option name="charting.axisY.minimumNumber">0</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.chart">line</option>
        <option name="charting.chart.overlayFields">status</option>
        <option name="charting.chart.showDataLabels">minmax</option>
        <option name="charting.legend.placement">bottom</option>
        <option name="charting.lineWidth">2</option>
        <option name="refresh.display">progressbar</option>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <title>ğŸ“… Scheduled Searches Inventory &amp; Cron Collision Detection</title>
      <table>
        <title>Active Scheduled Searches with Collision Detection</title>
        <search>
          <query>| rest /servicesNS/-/-/saved/searches splunk_server=local 
| where is_scheduled=1 AND disabled=0
| eval cron_pattern=cron_schedule
| eventstats count as collision_count by cron_schedule
| eval collision_status=case(
    collision_count &gt; 5, "ğŸ”´ HIGH COLLISION (".collision_count." searches)",
    collision_count &gt; 2, "ğŸŸ¡ MODERATE COLLISION (".collision_count." searches)",
    1=1, "ğŸŸ¢ NO COLLISION"
  )
| eval search_preview=substr(search, 1, 80)."..."
| eval next_run=strftime(relative_time(now(), cron_schedule), "%Y-%m-%d %H:%M:%S")
| table title, "eai:acl.app", author, cron_schedule, collision_status, collision_count, next_run, search_preview, actions, realtime_schedule, schedule_window
| rename title as "Search Title", "eai:acl.app" as "App", author as "Owner", cron_schedule as "Cron Pattern", collision_status as "Collision Status", collision_count as "Searches at Same Time", next_run as "Next Scheduled Run", search_preview as "Search Preview", actions as "Actions", realtime_schedule as "Realtime", schedule_window as "Window"
| sort - "Searches at Same Time", "Cron Pattern"</query>
          <earliest>$time_token.earliest$</earliest>
          <latest>$time_token.latest$</latest>
        </search>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <option name="rowNumbers">true</option>
        <option name="wrap">true</option>
        <format type="color" field="Collision Status">
          <colorPalette type="map">{"ğŸ”´ HIGH COLLISION": "#d93f3c", "ğŸŸ¡ MODERATE COLLISION": "#f7bc38", "ğŸŸ¢ NO COLLISION": "#65a637"}</colorPalette>
        </format>
        <drilldown>
          <link target="_blank">/manager/search/saved/searches/$row.Search Title$</link>
        </drilldown>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <html>
        <h1 style="text-align:center; color:#ff6b6b; font-size:22px; padding:10px;border-radius:8px;">
          ğŸš¨ Issue Identification &amp; Gap Analysis
        </h1>
      </html>
    </panel>
  </row>
  <row>
    <panel>
      <title>ğŸ” Top Issues Summary - Actionable Intelligence</title>
      <table>
        <search>
          <query>| makeresults
| eval issues=mvappend(
    "long_running_searches",
    "exceeding_schedule_window",
    "high_priority_skips",
    "peak_hour_contention",
    "cpu_critical",
    "memory_pressure",
    "disk_quota_exceeded"
  )
| mvexpand issues
| eval issue_type=case(
    issues="long_running_searches", "Long-Running Searches (&gt;5 min)",
    issues="exceeding_schedule_window", "Searches Exceeding Schedule Window",
    issues="high_priority_skips", "High-Priority Searches Being Skipped",
    issues="peak_hour_contention", "Resource Contention During Peak Hours",
    issues="cpu_critical", "Critical CPU Utilization (&gt;80%)",
    issues="memory_pressure", "Memory Pressure Detected",
    issues="disk_quota_exceeded", "Disk Quota Exceeded"
  )
| eval severity=case(
    issues="long_running_searches", "ğŸŸ¡ ELEVATED",
    issues="exceeding_schedule_window", "ğŸ”´ CRITICAL",
    issues="high_priority_skips", "ğŸ”´ CRITICAL",
    issues="peak_hour_contention", "ğŸŸ¡ ELEVATED",
    issues="cpu_critical", "ğŸ”´ CRITICAL",
    issues="memory_pressure", "ğŸŸ¡ ELEVATED",
    issues="disk_quota_exceeded", "ğŸ”´ CRITICAL"
  )
| eval recommended_action=case(
    issues="long_running_searches", "Consider summary indexing for searches with &gt;1min runtime. Optimize SPL logic.",
    issues="exceeding_schedule_window", "Extend schedule window or enable 'auto' mode. Review search efficiency.",
    issues="high_priority_skips", "Increase max_concurrent_searches or optimize critical searches to run faster.",
    issues="peak_hour_contention", "Stagger cron schedules. Identify and reschedule non-critical searches.",
    issues="cpu_critical", "Investigate workload distribution. Consider horizontal scaling or search optimization.",
    issues="memory_pressure", "Review memory-intensive searches. Optimize field extractions and stats commands.",
    issues="disk_quota_exceeded", "Clean up old summary indexes. Review retention policies."
  )
| eval count=if(isnull(count), 0, count)
| table issue_type, count, severity, recommended_action
| rename issue_type as "Issue Type", count as "Count", severity as "Severity", recommended_action as "Recommended Action"</query>
          <earliest>$time_token.earliest$</earliest>
          <latest>$time_token.latest$</latest>
        </search>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <option name="rowNumbers">true</option>
        <option name="wrap">true</option>
        <format type="color" field="Severity">
          <colorPalette type="map">{"ğŸ”´ CRITICAL": "#d93f3c", "ğŸŸ¡ ELEVATED": "#f7bc38", "ğŸŸ¢ NORMAL": "#65a637"}</colorPalette>
        </format>
      </table>
    </panel>
    <panel>
      <title>ğŸ’¡ Auto-Generated Resolution Recommendations</title>
      <table>
        <search>
          <query>index=_internal host=$host_token$ sourcetype=scheduler
| bin _time span=1h
| stats count as search_count, dc(savedsearch_name) as unique_searches, values(savedsearch_name) as search_names by _time
| where search_count &gt; 10
| eval recommendation="âš ï¸ Adjust cron schedules: ".unique_searches." searches run simultaneously at ".strftime(_time, "%H:%M").". Stagger by 5-10 minute intervals."
| append 
    [| rest /servicesNS/-/-/saved/searches splunk_server=local 
    | where is_scheduled=1 AND disabled=0 AND schedule_window!="auto"
    | stats count
    | eval recommendation="ğŸ’¡ Enable schedule window 'auto' for ".count." searches to prevent skips and improve scheduler flexibility"]
| append
    [search index=_internal  host=$host_token$  sourcetype=scheduler status=success 
    | eval runtime=run_time
    | where runtime &gt; 60
    | stats count, values(savedsearch_name) as long_searches
    | eval recommendation="ğŸ”§ Consider summary indexing for ".count." searches with &gt;1min runtime. Sample: ".mvindex(long_searches, 0)]
| append
    [| search index=_introspection  host=$host_token$ component=hostwide
    | eval cpu_pct='data.cpu_system_pct' + 'data.cpu_user_pct'
    | where cpu_pct &gt; 80
    | stats count by host_group
    | eval recommendation="ğŸš¨ CPU critical on ".host_group." - Investigate workload distribution and consider scaling"]
| eval priority=case(
    match(recommendation, "ğŸš¨"), "1 - CRITICAL",
    match(recommendation, "âš ï¸"), "2 - HIGH",
    match(recommendation, "ğŸ”§"), "3 - MEDIUM",
    1=1, "4 - LOW"
  )
| table priority, recommendation
| rename priority as "Priority", recommendation as "Recommendation"
| sort priority</query>
          <earliest>$time_token.earliest$</earliest>
          <latest>$time_token.latest$</latest>
        </search>
        <option name="count">15</option>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
        <option name="rowNumbers">true</option>
        <option name="wrap">true</option>
        <format type="color" field="Priority">
          <colorPalette type="map">{"1 - CRITICAL": "#d93f3c", "2 - HIGH": "#f58231", "3 - MEDIUM": "#f7bc38", "4 - LOW": "#4ECDC4"}</colorPalette>
        </format>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>â±ï¸ Long-Running Searches (&gt;5 minutes)</title>
      <table>
        <search>
          <query>index=_audit action=search info=completed host=$host_token$
| eval runtime_seconds=total_run_time
| where runtime_seconds &gt; 300
| eval runtime_minutes=round(runtime_seconds/60, 2)
| eval performance_impact=case(
    runtime_seconds &gt; 1800, "ğŸ”´ SEVERE (&gt;30min)",
    runtime_seconds &gt; 900, "ğŸŸ¡ HIGH (15-30min)",
    runtime_seconds &gt; 300, "ğŸŸ  MODERATE (5-15min)",
    1=1, "ğŸŸ¢ NORMAL"
  )
| eval optimization_tip=case(
    runtime_seconds &gt; 1800, "Critical: Convert to summary index or report acceleration",
    runtime_seconds &gt; 900, "High priority: Review SPL efficiency, add index/sourcetype filters early",
    runtime_seconds &gt; 300, "Consider: Use tstats, optimize field extractions, limit time range",
    1=1, "Monitor"
  )
| table _time, user, search, runtime_minutes, performance_impact, optimization_tip, total_run_time, event_count, scan_count
| convert ctime(_time)
| rename _time as "Execution Time", user as "User", search as "Search Query", runtime_minutes as "Runtime (min)", performance_impact as "Impact", optimization_tip as "Optimization Recommendation", total_run_time as "Seconds", event_count as "Events", scan_count as "Scanned"
| sort -"Runtime (min)"</query>
          <earliest>$time_token.earliest$</earliest>
          <latest>$time_token.latest$</latest>
        </search>
        <option name="count">7</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <option name="rowNumbers">true</option>
        <option name="wrap">true</option>
        <format type="color" field="Impact">
          <colorPalette type="map">{"ğŸ”´ SEVERE (&gt;30min)": "#d93f3c", "ğŸŸ¡ HIGH (15-30min)": "#f7bc38", "ğŸŸ  MODERATE (5-15min)": "#f58231"}</colorPalette>
        </format>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>ğŸ“Š Search Performance Benchmarks - Runtime Analysis</title>
      <table>
        <search>
          <query>index=_audit action=search info=completed host=$host_token$ savedsearch_name=*
| eval runtime_sec=total_run_time
| bin _time span=1h
| stats avg(runtime_sec) as avg_runtime, perc90(runtime_sec) as p90_runtime, max(runtime_sec) as max_runtime latest(_time) as _time by savedsearch_name
| eval degradation_status=case(
    avg_runtime &gt; 1800, "ğŸ”´ SEVERE DEGRADATION (&gt;30min)",
    avg_runtime &gt; 600, "ğŸŸ¡ MODERATE DEGRADATION (10-30min)",
    1=1, "ğŸŸ  MINOR DEGRADATION (5-10min)"
    ) 
| where avg_runtime &gt; 300
| sort - avg_runtime
| table _time savedsearch_name, avg_runtime, p90_runtime, max_runtime, degradation_status
| rename degradation_status as Status, avg_runtime as "Avg. Run Time", max_runtime as "Max Run Time"</query>
          <earliest>$time_token.earliest$</earliest>
          <latest>$time_token.latest$</latest>
        </search>
        <option name="drilldown">cell</option>
        <option name="refresh.display">progressbar</option>
        <format type="color" field="Status">
          <colorPalette type="map">{"ğŸ”´ SEVERE DEGRADATION (&gt;30min)": "#d93f3c", "ğŸŸ¡ MODERATE DEGRADATION (10-30min)": "#f7bc38", "ğŸŸ  MINOR DEGRADATION (5-10min)": #f58231"}</colorPalette>
        </format>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>ğŸ“ˆ Performance Degradation Detection</title>
      <table>
        <search>
          <query>index=_audit action=search info=completed host=$host_token$ savedsearch_name=* 
| eval runtime_sec=total_run_time 
| bin _time span=1h 
| stats avg(runtime_sec) as avg_runtime values(provenance) as provenance values(user) as user by _time, savedsearch_name 
| sort savedsearch_name, _time 
| streamstats current=f last(avg_runtime) as prev_runtime values(provenance) as provenance values(user) as user by savedsearch_name 
| eval pct_change=round(((avg_runtime-prev_runtime)/prev_runtime)*100, 2) 
| where pct_change &gt; 50 
| eval degradation_status=case(
    pct_change &gt; 100, "ğŸ”´ SEVERE DEGRADATION (&gt;100%)",
    pct_change &gt; 80, "ğŸŸ¡ MODERATE DEGRADATION (80-100%)",
    1=1, "ğŸŸ  MINOR DEGRADATION (50-80%)"
    ) 
| eval recommendation="Investigate data volume increase, SPL efficiency, or infrastructure changes" 
| table savedsearch_name, provenance, user, _time, avg_runtime, prev_runtime, pct_change, degradation_status, recommendation 
| convert ctime(_time) 
| rename savedsearch_name as "Search Name", _time as "Period", avg_runtime as "Current Avg (sec)", prev_runtime as "Previous Avg (sec)", pct_change as "Change %", degradation_status as "Status", recommendation as "Recommendation" 
| sort -"Change %"</query>
          <earliest>$time_token.earliest$</earliest>
          <latest>$time_token.latest$</latest>
        </search>
        <option name="count">5</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <option name="rowNumbers">true</option>
        <format type="color" field="Status">
          <colorPalette type="map">{"ğŸ”´ SEVERE DEGRADATION (&gt;100%)": "#d93f3c", "ğŸŸ¡ MODERATE DEGRADATION (50-100%)": "#f7bc38", "ğŸŸ  MINOR DEGRADATION (20-50%)": "#f58231"}</colorPalette>
        </format>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>â° Concurrent Execution Peaks (&gt;10 cron jobs)</title>
      <table>
        <search>
          <query>index=_internal host=$host_token$ sourcetype=scheduler 
| bin _time span=1m
| stats dc(savedsearch_name) as concurrent_searches, values(savedsearch_name) as search_list by _time
| where concurrent_searches &gt; 10
| eval peak_level=case(
    concurrent_searches &gt; 20, "ğŸ”´ CRITICAL",
    concurrent_searches &gt; 15, "ğŸŸ¡ HIGH",
    1=1, "ğŸŸ  MODERATE"
  )
| eval recommendation="Stagger cron schedules. Consider using schedule window='auto' for ".concurrent_searches." searches"
| convert ctime(_time)
| table _time, peak_level, concurrent_searches, recommendation, search_list
| rename _time as "Peak Time", peak_level as "Severity", concurrent_searches as "Concurrent Jobs", recommendation as "Recommended Action", search_list as "Affected Searches"
| sort -"Concurrent Jobs"</query>
          <earliest>$time_token.earliest$</earliest>
          <latest>$time_token.latest$</latest>
        </search>
        <option name="count">1</option>
        <option name="drilldown">row</option>
        <option name="refresh.display">progressbar</option>
        <option name="rowNumbers">true</option>
        <format type="color" field="Severity">
          <colorPalette type="map">{"ğŸ”´ CRITICAL": "#d93f3c", "ğŸŸ¡ HIGH": "#f7bc38", "ğŸŸ  MODERATE": "#f58231"}</colorPalette>
        </format>
      </table>
    </panel>
  </row>
</form>
