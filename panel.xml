<form version="1.1" theme="dark">
  <label>üéØ Splunk Cloud Assessment - Executive Overview</label>
  <description>Comprehensive platform health assessment based on real-time metrics from Splunk Cloud environment</description>

  <fieldset submitButton="true" autoRun="true">
    <input type="time" token="time_token" searchWhenChanged="true">
      <label>Time Range</label>
      <default>
        <earliest>-24h@h</earliest>
        <latest>now</latest>
      </default>
    </input>
  </fieldset>

  <!-- Executive Header -->
  <row>
    <panel>
      <html>
        <h1 style="text-align:center; color:#1e93ff; font-size:28px; padding:15px; border-radius:8px; background: linear-gradient(135deg, rgba(30,147,255,0.1) 0%, rgba(78,205,196,0.1) 100%);">
          üéØ Splunk Cloud Platform Assessment - Executive Dashboard
        </h1>
        <p style="text-align:center; color:#999; font-size:14px; margin-top:-10px;">
          Real-time platform health metrics | ES + Ad-hoc Search Heads | SVC-Based Licensing
        </p>
      </html>
    </panel>
  </row>

  <!-- Splunk Entitlements & Usage Section -->
  <row>
    <panel>
      <html>
        <h2 style="text-align:center; color:#4ECDC4; font-size:18px; padding:8px; border-bottom:2px solid #4ECDC4;">
          üìã Splunk Entitlements &amp; Usage
        </h2>
      </html>
    </panel>
  </row>

  <!-- Entitlement Quotas Row -->
  <row>
    <panel>
      <title>üé´ SVC Entitlement (Quota)</title>
      <single>
        <search>
          <query>| rest /services/licenser/pools splunk_server=local
| stats sum(quota_bytes) as total_quota
| eval SVC_quota=if(isnull(total_quota), 1800, round(total_quota/1073741824/24,0))
| fields SVC_quota</query>
        </search>
        <option name="colorMode">block</option>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0x1e93ff"]</option>
        <option name="refresh.display">progressbar</option>
        <option name="underLabel">Allocated SVC Units</option>
        <option name="unit"> SVC</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>üì• Daily Ingestion Entitlement (Quota)</title>
      <single>
        <search>
          <query>| rest /services/licenser/pools splunk_server=local
| stats sum(quota_bytes) as total_quota
| eval quota_TB=round(total_quota/1024/1024/1024/1024,2)
| fields quota_TB</query>
        </search>
        <option name="colorMode">block</option>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0x1e93ff"]</option>
        <option name="refresh.display">progressbar</option>
        <option name="underLabel">License Limit (TB/day)</option>
        <option name="unit"> TB</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>üì¶ DDAA Entitlement (Quota)</title>
      <single>
        <search>
          <query>| rest /services/licenser/groups splunk_server=local
| search title="*DDAA*" OR title="*Archive*"
| stats sum(stack_quota) as ddaa_quota
| eval ddaa_TB=if(isnull(ddaa_quota) OR ddaa_quota=0, "N/A", round(ddaa_quota/1024/1024/1024/1024,2))
| fields ddaa_TB</query>
        </search>
        <option name="colorMode">block</option>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0x9b59b6"]</option>
        <option name="refresh.display">progressbar</option>
        <option name="underLabel">Dynamic Data Active Archive</option>
        <option name="unit"> TB</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>üóÑÔ∏è DDAS Entitlement (Quota)</title>
      <single>
        <search>
          <query>| rest /services/licenser/groups splunk_server=local
| search title="*DDAS*" OR title="*Searchable*"
| stats sum(stack_quota) as ddas_quota
| eval ddas_TB=if(isnull(ddas_quota) OR ddas_quota=0, "N/A", round(ddas_quota/1024/1024/1024/1024,2))
| fields ddas_TB</query>
        </search>
        <option name="colorMode">block</option>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0xe67e22"]</option>
        <option name="refresh.display">progressbar</option>
        <option name="underLabel">Dynamic Data Active Searchable</option>
        <option name="unit"> TB</option>
        <option name="useColors">1</option>
      </single>
    </panel>
  </row>

  <!-- Current Usage Row -->
  <row>
    <panel>
      <title>üìä SVC Usage (Current)</title>
      <single>
        <search>
          <query>index=_introspection sourcetype=splunk_resource_usage component=PerProcess data.search_props.sid=*
| stats sum(data.mem_used) as mem_mb, sum(data.elapsed) as elapsed_sec
| eval SVC_estimate=round((mem_mb/1024)*(elapsed_sec/3600),0)
| eval SVC_estimate=if(isnull(SVC_estimate) OR SVC_estimate=0, 0, SVC_estimate)
| fields SVC_estimate</query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <option name="colorMode">block</option>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0x65a637","0xf7bc38","0xd93f3c"]</option>
        <option name="rangeValues">[1440,1620]</option>
        <option name="refresh.display">progressbar</option>
        <option name="underLabel">Used SVC (24h Estimate)</option>
        <option name="unit"> SVC</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>üìà Daily Ingestion Usage (Current)</title>
      <single>
        <search>
          <query>index=_internal source=*license_usage.log type=Usage
| stats sum(b) as bytes
| eval TB=round(bytes/1024/1024/1024/1024,2)
| fields TB</query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <option name="colorMode">block</option>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0x65a637","0xf7bc38","0xd93f3c"]</option>
        <option name="rangeValues">[13,15]</option>
        <option name="refresh.display">progressbar</option>
        <option name="underLabel">Ingested Today (TB)</option>
        <option name="unit"> TB</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>üì¶ DDAA Usage (Current)</title>
      <single>
        <search>
          <query>| rest /services/data/indexes splunk_server=local
| search archiver.enableDataArchive=1 OR title="*archive*"
| stats sum(totalEventCount) as archived_events, sum(currentDBSizeMB) as size_mb
| eval size_TB=round(size_mb/1024/1024,2)
| eval size_TB=if(isnull(size_TB) OR size_TB=0, "N/A", size_TB)
| fields size_TB</query>
        </search>
        <option name="colorMode">block</option>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0x65a637","0xf7bc38","0xd93f3c"]</option>
        <option name="rangeValues">[50,80]</option>
        <option name="refresh.display">progressbar</option>
        <option name="underLabel">Archive Storage Used</option>
        <option name="unit"> TB</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>üóÑÔ∏è DDAS Usage (Current)</title>
      <single>
        <search>
          <query>| rest /services/data/indexes splunk_server=local
| search datatype=event
| stats sum(currentDBSizeMB) as size_mb
| eval size_TB=round(size_mb/1024/1024,2)
| fields size_TB</query>
        </search>
        <option name="colorMode">block</option>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0x65a637","0xf7bc38","0xd93f3c"]</option>
        <option name="rangeValues">[100,140]</option>
        <option name="refresh.display">progressbar</option>
        <option name="underLabel">Searchable Storage Used</option>
        <option name="unit"> TB</option>
        <option name="useColors">1</option>
      </single>
    </panel>
  </row>

  <!-- Search Performance KPIs -->
  <row>
    <panel>
      <title>üìä Search Success Rate</title>
      <single>
        <search>
          <query>index=_internal sourcetype=scheduler status=*
| stats count(eval(status="success")) as success, count as total
| eval pct=round((success/total)*100,1)
| fields pct</query>
          <earliest>$time_token.earliest$</earliest>
          <latest>$time_token.latest$</latest>
        </search>
        <option name="colorMode">block</option>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0.0</option>
        <option name="rangeColors">["0xd93f3c","0xf7bc38","0x65a637"]</option>
        <option name="rangeValues">[90,95]</option>
        <option name="refresh.display">progressbar</option>
        <option name="underLabel">Target: &gt;98%</option>
        <option name="unit">%</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>‚è≠Ô∏è Skipped Searches</title>
      <single>
        <search>
          <query>index=_internal sourcetype=scheduler status="skipped"
| stats count</query>
          <earliest>$time_token.earliest$</earliest>
          <latest>$time_token.latest$</latest>
        </search>
        <option name="colorMode">block</option>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0x65a637","0xf7bc38","0xd93f3c"]</option>
        <option name="rangeValues">[5,20]</option>
        <option name="refresh.display">progressbar</option>
        <option name="underLabel">Target: 0</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>‚è±Ô∏è Avg Search Latency</title>
      <single>
        <search>
          <query>index=_internal sourcetype=scheduler status="success"
| stats avg(run_time) as avg_runtime
| eval avg_runtime=round(avg_runtime,1)
| fields avg_runtime</query>
          <earliest>$time_token.earliest$</earliest>
          <latest>$time_token.latest$</latest>
        </search>
        <option name="colorMode">block</option>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0.0</option>
        <option name="rangeColors">["0x65a637","0xf7bc38","0xd93f3c"]</option>
        <option name="rangeValues">[30,60]</option>
        <option name="refresh.display">progressbar</option>
        <option name="underLabel">Target: &lt;30 sec</option>
        <option name="unit"> sec</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>üìà Total Scheduled Searches</title>
      <single>
        <search>
          <query>| rest /servicesNS/-/-/saved/searches splunk_server=local
| search is_scheduled=1 disabled=0
| stats count</query>
        </search>
        <option name="colorMode">block</option>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0x1e93ff"]</option>
        <option name="refresh.display">progressbar</option>
        <option name="underLabel">Active Scheduled Searches</option>
        <option name="useColors">1</option>
      </single>
    </panel>
  </row>

  <!-- License & Resource KPIs -->
  <row>
    <panel>
      <title>ÔøΩ Daily Ingest (GB)</title>
      <single>
        <search>
          <query>index=_internal source=*license_usage.log type=Usage
| stats sum(b) as bytes
| eval GB=round(bytes/1024/1024/1024,2)
| fields GB</query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <option name="colorMode">block</option>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0.00</option>
        <option name="rangeColors">["0x65a637","0xf7bc38","0xd93f3c"]</option>
        <option name="rangeValues">[13000,15000]</option>
        <option name="refresh.display">progressbar</option>
        <option name="underLabel">Last 24h</option>
        <option name="unit"> GB</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>ÔøΩ CPU Utilization %</title>
      <single>
        <search>
          <query>index=_introspection component=Hostwide
| eval cpu_pct=round('data.cpu_system_pct' + 'data.cpu_user_pct', 1)
| stats avg(cpu_pct) as cpu_pct
| eval cpu_pct=round(cpu_pct,1)
| fields cpu_pct</query>
          <earliest>-15m</earliest>
          <latest>now</latest>
        </search>
        <option name="colorMode">block</option>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0.0</option>
        <option name="rangeColors">["0x65a637","0xf7bc38","0xd93f3c"]</option>
        <option name="rangeValues">[60,80]</option>
        <option name="refresh.display">progressbar</option>
        <option name="underLabel">Target: &lt;60%</option>
        <option name="unit">%</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>üß† Memory Usage %</title>
      <single>
        <search>
          <query>index=_introspection component=Hostwide
| eval mem_pct=round(('data.mem_used'/'data.mem')*100, 1)
| stats avg(mem_pct) as mem_pct
| eval mem_pct=round(mem_pct,1)
| fields mem_pct</query>
          <earliest>-15m</earliest>
          <latest>now</latest>
        </search>
        <option name="colorMode">block</option>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0.0</option>
        <option name="rangeColors">["0x65a637","0xf7bc38","0xd93f3c"]</option>
        <option name="rangeValues">[75,90]</option>
        <option name="refresh.display">progressbar</option>
        <option name="underLabel">Target: &lt;75%</option>
        <option name="unit">%</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>ÔøΩ Queue Fill %</title>
      <single>
        <search>
          <query>index=_internal source=*metrics.log group=queue
| eval fill_pct=round((current_size/max_size)*100, 1)
| stats avg(fill_pct) as fill_pct
| eval fill_pct=round(fill_pct,1)
| fields fill_pct</query>
          <earliest>-15m</earliest>
          <latest>now</latest>
        </search>
        <option name="colorMode">block</option>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0.0</option>
        <option name="rangeColors">["0x65a637","0xf7bc38","0xd93f3c"]</option>
        <option name="rangeValues">[60,80]</option>
        <option name="refresh.display">progressbar</option>
        <option name="underLabel">Target: &lt;60%</option>
        <option name="unit">%</option>
        <option name="useColors">1</option>
      </single>
    </panel>
  </row>

  <!-- Critical Issues Section -->
  <row>
    <panel>
      <html>
        <h2 style="text-align:center; color:#d93f3c; font-size:18px; padding:8px;">
          ‚ö†Ô∏è Critical Issues Detection
        </h2>
      </html>
    </panel>
  </row>

  <row>
    <panel>
      <title>ÔøΩ Long-Running Searches (&gt;5 min)</title>
      <single>
        <search>
          <query>index=_audit action=search info=completed
| eval runtime=tonumber(total_run_time)
| where runtime > 300
| stats dc(search_id) as count</query>
          <earliest>$time_token.earliest$</earliest>
          <latest>$time_token.latest$</latest>
        </search>
        <option name="colorMode">block</option>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0x65a637","0xf7bc38","0xd93f3c"]</option>
        <option name="rangeValues">[20,50]</option>
        <option name="refresh.display">progressbar</option>
        <option name="underLabel">Target: &lt;20</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>ÔøΩ Auth Failures</title>
      <single>
        <search>
          <query>index=_audit action=login info=failed
| stats count</query>
          <earliest>$time_token.earliest$</earliest>
          <latest>$time_token.latest$</latest>
        </search>
        <option name="colorMode">block</option>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0x65a637","0xf7bc38","0xd93f3c"]</option>
        <option name="rangeValues">[10,50]</option>
        <option name="refresh.display">progressbar</option>
        <option name="underLabel">Login Failures</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>ÔøΩ Error Events</title>
      <single>
        <search>
          <query>index=_internal log_level=ERROR
| stats count</query>
          <earliest>$time_token.earliest$</earliest>
          <latest>$time_token.latest$</latest>
        </search>
        <option name="colorMode">block</option>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0x65a637","0xf7bc38","0xd93f3c"]</option>
        <option name="rangeValues">[100,500]</option>
        <option name="refresh.display">progressbar</option>
        <option name="underLabel">Internal Errors</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>üî¥ Deferred Searches</title>
      <single>
        <search>
          <query>index=_internal sourcetype=scheduler status="deferred"
| stats count</query>
          <earliest>$time_token.earliest$</earliest>
          <latest>$time_token.latest$</latest>
        </search>
        <option name="colorMode">block</option>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0x65a637","0xf7bc38","0xd93f3c"]</option>
        <option name="rangeValues">[5,20]</option>
        <option name="refresh.display">progressbar</option>
        <option name="underLabel">Resource contention</option>
        <option name="useColors">1</option>
      </single>
    </panel>
  </row>

  <!-- User & Access KPIs -->
  <row>
    <panel>
      <html>
        <h2 style="text-align:center; color:#4ECDC4; font-size:18px; padding:8px;">
          ÔøΩ User &amp; Access Metrics
        </h2>
      </html>
    </panel>
  </row>

  <row>
    <panel>
      <title>ÔøΩ Total Users</title>
      <single>
        <search>
          <query>| rest /services/authentication/users splunk_server=local
| stats count</query>
        </search>
        <option name="colorMode">block</option>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0x1e93ff"]</option>
        <option name="refresh.display">progressbar</option>
        <option name="underLabel">Configured Users</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>ÔøΩ Admin Accounts</title>
      <single>
        <search>
          <query>| rest /services/authentication/users splunk_server=local
| mvexpand roles
| search roles="admin" OR roles="sc_admin"
| stats dc(title) as count</query>
        </search>
        <option name="colorMode">block</option>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0x65a637","0xf7bc38","0xd93f3c"]</option>
        <option name="rangeValues">[10,15]</option>
        <option name="refresh.display">progressbar</option>
        <option name="underLabel">Target: &lt;10</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>ÔøΩ Active Logins Today</title>
      <single>
        <search>
          <query>index=_audit action=login info=succeeded
| stats dc(user) as count</query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <option name="colorMode">block</option>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0x4ECDC4"]</option>
        <option name="refresh.display">progressbar</option>
        <option name="underLabel">Unique Users (24h)</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <title>ÔøΩ Roles Count</title>
      <single>
        <search>
          <query>| rest /services/authorization/roles splunk_server=local
| stats count</query>
        </search>
        <option name="colorMode">block</option>
        <option name="drilldown">none</option>
        <option name="rangeColors">["0x1e93ff"]</option>
        <option name="refresh.display">progressbar</option>
        <option name="underLabel">Defined Roles</option>
        <option name="useColors">1</option>
      </single>
    </panel>
  </row>

  <!-- Top Issues Table -->
  <row>
    <panel>
      <title>ÔøΩ Top Issues by Category</title>
      <table>
        <search>
          <query>| union
    [search index=_internal sourcetype=scheduler status="skipped" | stats count as issue_count | eval issue_type="Skipped Searches", severity=case(issue_count>20, "üî¥ CRITICAL", issue_count>5, "üü° ELEVATED", 1=1, "üü¢ NORMAL"), recommendation="Review concurrency limits"]
    [search index=_audit action=search info=completed | eval runtime=tonumber(total_run_time) | where runtime > 300 | stats count as issue_count | eval issue_type="Long-Running Searches", severity=case(issue_count>50, "üî¥ CRITICAL", issue_count>20, "üü° ELEVATED", 1=1, "üü¢ NORMAL"), recommendation="Optimize expensive searches"]
    [search index=_audit action=login info=failed | stats count as issue_count | eval issue_type="Auth Failures", severity=case(issue_count>50, "ÔøΩ CRITICAL", issue_count>10, "üü° ELEVATED", 1=1, "üü¢ NORMAL"), recommendation="Review failed login attempts"]
    [search index=_internal log_level=ERROR | stats count as issue_count | eval issue_type="Error Events", severity=case(issue_count>500, "üî¥ CRITICAL", issue_count>100, "üü° ELEVATED", 1=1, "üü¢ NORMAL"), recommendation="Investigate error sources"]
| table severity, issue_type, issue_count, recommendation
| rename severity as "Severity", issue_type as "Issue Type", issue_count as "Count", recommendation as "Recommendation"
| sort - Count</query>
          <earliest>$time_token.earliest$</earliest>
          <latest>$time_token.latest$</latest>
        </search>
        <option name="count">10</option>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
        <option name="wrap">true</option>
        <format type="color" field="Severity">
          <colorPalette type="map">{"üî¥ CRITICAL": "#d93f3c", "üü° ELEVATED": "#f7bc38", "üü¢ NORMAL": "#65a637"}</colorPalette>
        </format>
      </table>
    </panel>
  </row>

  <!-- Quick Navigation Links -->
  <row>
    <panel>
      <html>
        <h2 style="text-align:center; color:#4ECDC4; font-size:18px; padding:8px;">
          üîó Quick Navigation to Detailed Dashboards
        </h2>
        <div style="text-align:center; padding:20px;">
          <a href="assessment_license_consumption" style="color:#1e93ff; text-decoration:none; padding:10px 20px; margin:5px; border:1px solid #1e93ff; border-radius:5px; display:inline-block;">üìä License &amp; SVC</a>
          <a href="soc_search_performance_monitoring_dashboard" style="color:#1e93ff; text-decoration:none; padding:10px 20px; margin:5px; border:1px solid #1e93ff; border-radius:5px; display:inline-block;">üîç Search Performance</a>
          <a href="assessment_es_health" style="color:#1e93ff; text-decoration:none; padding:10px 20px; margin:5px; border:1px solid #1e93ff; border-radius:5px; display:inline-block;">üõ°Ô∏è ES Health</a>
          <a href="assessment_access_rbac" style="color:#1e93ff; text-decoration:none; padding:10px 20px; margin:5px; border:1px solid #1e93ff; border-radius:5px; display:inline-block;">üë• Access &amp; RBAC</a>
          <a href="assessment_platform_health" style="color:#1e93ff; text-decoration:none; padding:10px 20px; margin:5px; border:1px solid #1e93ff; border-radius:5px; display:inline-block;">üíª Platform Health</a>
          <a href="assessment_security_posture" style="color:#1e93ff; text-decoration:none; padding:10px 20px; margin:5px; border:1px solid #1e93ff; border-radius:5px; display:inline-block;">üîê Security Posture</a>
        </div>
      </html>
    </panel>
  </row>

</form>
